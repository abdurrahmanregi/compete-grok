# CompeteGrok Analysis Report

**Query:** """
explain step by step BLP demand estimation. how is it being used in competition analysis?
"""

**Timestamp:** 2025-12-18 11:12:51.214624

**Routes:** []

### Step-by-Step Explanation of BLP Demand Estimation

The **Berry-Levinsohn-Pakes (BLP)** model (Berry, Levinsohn, Pakes 1995, *Econometrica*) is a workhorse for estimating demand in markets with **differentiated products** (e.g., automobiles, cereals, airlines). It overcomes the multinomial logit (MNL)'s rigid **Independence of Irrelevant Alternatives (IIA)** assumption by incorporating **random coefficients** on product characteristics and price, capturing consumer heterogeneity and realistic substitution patterns.

BLP uses **market-level data** (shares, prices, characteristics) and a **generalized method of moments (GMM)** estimator. Here's the step-by-step process:

#### 1. **Model Specification: Random Coefficients Utility**
   - Utility for consumer \(i\), product \(j\) in market \(t\):
     \[
     u_{ijt} = \underbrace{x_{jt}'\beta + \alpha p_{jt} + \xi_{jt}}_{\delta_{jt}} + \underbrace{\sigma \nu_{i} \odot x_{jt} + \sigma_p \nu_{ip} p_{jt}}_{\mu_{ijt}(\theta_2)} + \epsilon_{ijt}
     \]
     - \(\delta_{jt}\): **Mean utility** (linear in observed chars \(x_{jt}\), price \(p_{jt}\), unobserved demand shock \(\xi_{jt}\)).
     - \(\mu_{ijt}\): **Heterogeneous component** (random taste shocks \(\nu_i \sim N(0,I)\), interacted with chars; \(\theta_2 = \{\sigma, \sigma_p\}\)).
     - \(\epsilon_{ijt}\): i.i.d. Type I extreme value (logit shocks).
   - **Outside option**: \(u_{i0t} = \epsilon_{i0t}\), share \(s_{0t} = 1 - \sum_j s_{jt}\).
   - Parameters: \(\theta = \{\theta_1 = \{\beta, \alpha\}, \theta_2\}\).

#### 2. **Market Share Equation**
   - Choice prob:
     \[
     s_{jt}(\delta_t, \theta_2) = \int \frac{\exp(\delta_{jt} + \mu_{ijt}(\theta_2))}{1 + \sum_m \exp(\delta_{mt} + \mu_{imt}(\theta_2))} dF(\nu_i)
     \]
   - **Simulate** integral with \(R=500-1000\) draws (quasi-Monte Carlo, e.g., Halton sequences).
   - Observed share \(s_{jt}\) identifies model implicitly.

#### 3. **Contraction Mapping: Recover \(\delta_{jt}\)** (Inner Loop)
   - Shares **monotonically increasing** in \(\delta_{jt}\), so **invert**:
     \[
     \delta_{jt} = \mathcal{D}_t(s_{jt}, s_{0t}; \theta_2)
     \]
   - Solve fixed-point: Start with logit \(\delta^{(0)}\), iterate:
     \[
     \delta^{(r+1)} = \ln(s_j) - \ln(s_0) + \ln\left(1 + \sum_m s_m [\exp(\mu_m(\delta^{(r)}, \theta_2)) - 1]\right)
     \]
   - Converges rapidly (~10 iterations); Broyden's method accelerates.

#### 4. **Decompose Mean Utility** (Endogeneity Setup)
   \[
   \delta_{jt} = x_{jt}'\beta + \alpha p_{jt} + \xi_{jt}(\theta)
   \]
   - **Price endogeneity**: \(\text{Cov}(p_{jt}, \xi_{jt}) > 0\) (firms mark up quality).

#### 5. **GMM Estimation** (Outer Loop)
   - Instruments \(Z_{jt}\): Cost shifters (input prices), Hausman (mean char of other firms), BLP-optimal (\(E[x_k | x_j]\)).
   - Moments: \(E[Z_{jt} \xi_{jt}(\theta)] = 0\).
   - Minimize:
     \[
     \hat{\theta} = \arg\min_\theta \left( \frac{1}{T}\sum_t \xi_t(\theta)' Z_t \right) W \left( \frac{1}{T}\sum_t Z_t' \xi_t(\theta) \right)
     \]
   - **Two-step**: \(W = I\) first, then \(W = \hat{V}^{-1}\) (optimal).
   - **Iteration**: Update \(\theta_2 \to \delta \to \xi \to\) GMM until convergence.
   - Std. errors via **cluster-robust** GMM variance.

#### 6. **Post-Estimation Outputs**
   - **Elasticities**:
     \[
     e_{jm} = \frac{\partial s_j}{\partial p_m} \frac{p_m}{s_j} = s_j \left( \frac{w_{jm}}{s_m} - \delta_{jm} \right)
     \]
     (analytical form; \(w_{jm} =\) avg. share-weighted choice prob).
   - **Marginal costs** (w/ supply): \(mc_{jt} = \frac{p_{jt}}{1 + \omega_{jt} s_{jt}}\), where \(\omega_{jt}\) from markup eq.
   - Diversion ratios: \(d_{jm} = \frac{\partial s_j / \partial p_m}{\partial s_m / \partial p_m}\).

#### Implementation Summary
| Step | Computation | Tools |
|------|-------------|-------|
| Simulate Shares | \(R=500\) Halton draws | pyblp (Python), BLPestimatoR (R) |
| Inversion | Contraction (10 iter.) | ~1s/market |
| GMM | BFGS/NLM | Full est: minutes-hours |
| Data | Shares = revenue/(P·Q_market), chars, prices | Nielsen/IRI, Census |

**Challenges**: Weak IVs → over-rejection; multiple equilibria (rare); large \(s_0\).

### Use in Competition Analysis
BLP dominates **antitrust economics** (DOJ/FTC Horizontal Merger Guidelines 2010/2023) for **structural simulation**:

1. **Merger Review**:
   - **Pre/post-simulation**: Fix demand params, re-optimize prices under new ownership (Nash-Bertrand).
   - **UPP/GUPPI**: \(p \cdot d_{jm} \cdot \text{margin}_m\) predicts price pressure.
   - Example: Staples-Office Depot (blocked 1997; BLP showed 10% price rise).

2. **Market Power Measurement**:
   - Lerner: \(L_j = s_j / |e_{jj}|\).
   - Test collusion: Compare simulated vs. observed markups.

3. **Counterfactuals**:
   | Policy | BLP Role |
   |--------|----------|
   | Horizontal merger | ΔP = 5-20% typical |
   | Entry/exit | Equilibrium price effects |
   | Cartel damages | Overcharge = Σ markup excess |
   | Vertical | Bargaining power |

4. **Real Cases**:
   | Industry | Key Papers/Cases |
   |----------|-----------------|
   | Automobiles | BLP (1995), Petrin (2002 minivan entry) |
   | Airlines | Berry et al. (1995 routes) |
   | Pharma | FDA generic entry (Dubois/Garoupa) |
   | Tech | Google Shopping (EU), Apple e-books (DOJ) |

**Advantages over reduced-form**: Endogenous prices, heterogeneity → credible causal elasticities/diversions. Guides HHI screens + simulations.

**Code**: `pyblp` tutorial (pip install pyblp) simulates cereals in ~2min. See Nevo (2000 QJE) for yogurt application.

Questions on IVs, supply-side, or extensions (dynamic BLP)?


**Privacy:** Ephemeral RAG; zero retention.
**Disclaimer:** Not legal advice. Models have caveats (e.g. IIA assumption). Verify 2025 data.
**LaTeX:** Inline $x$, display $$E=mc^2$$.
